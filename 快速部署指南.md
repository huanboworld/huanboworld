# 环舶物流网站 - 30分钟快速部署指南

## 🎯 专为中国大陆用户设计的最简部署方案

基于您的反馈（Vercel部署失败，Railway无免费版），我为您提供最适合的部署方案。

---

## 🚀 推荐方案：腾讯云轻量应用服务器

### 为什么选择这个方案？
- ✅ **中国大陆网络友好**：访问速度快，微信内正常打开
- ✅ **无需GitHub**：直接上传代码，不依赖国外服务
- ✅ **成本可控**：新用户¥24/月起，有免费试用
- ✅ **部署简单**：30分钟内完成部署
- ✅ **维护方便**：图形化管理界面

---

## 📋 部署前准备清单

### 必需准备
- [ ] 腾讯云账号（需要实名认证）
- [ ] 一个邮箱（QQ邮箱推荐）
- [ ] 项目代码压缩包
- [ ] 约30分钟时间

### 可选准备
- [ ] 域名（如需自定义域名）
- [ ] 备案（如使用自有域名）

---

## ⚡ 30分钟快速部署

### 第一步：购买服务器（5分钟）

1. **注册腾讯云账号**
   - 访问：https://cloud.tencent.com
   - 点击"免费注册"
   - 完成实名认证

2. **购买轻量应用服务器**
   ```
   产品：轻量应用服务器
   地域：上海（推荐）
   镜像：Ubuntu 20.04 LTS
   套餐：2核2G内存（¥24/月）
   购买时长：1个月（测试）或更长
   ```

3. **等待创建完成**
   - 通常1-3分钟完成
   - 记录服务器IP地址

### 第二步：准备代码包（3分钟）

```bash
# 在本地HuanboWorld目录下执行
# 删除不需要的文件
rm -rf .git node_modules .DS_Store

# 创建部署包
tar -czf huanboworld.tar.gz .

# 或者使用zip（Windows用户）
# 选择所有文件，右键 → 压缩为zip
```

### 第三步：连接服务器（2分钟）

1. **使用网页终端（推荐）**
   - 腾讯云控制台 → 轻量应用服务器
   - 选择你的服务器
   - 点击"登录"按钮
   - 选择"立即登录"

2. **或使用SSH（技术用户）**
   ```bash
   ssh root@你的服务器IP
   # 输入管理员密码
   ```

### 第四步：一键安装环境（5分钟）

在服务器终端中执行：

```bash
# 复制粘贴以下命令，一次执行完成
curl -fsSL https://raw.githubusercontent.com/nodesource/distributions/master/deb/setup_18.x | sudo -E bash - && \
apt-get install -y nodejs nginx && \
npm install -g pm2 && \
mkdir -p /www && \
echo "环境安装完成！"
```

### 第五步：上传代码（5分钟）

**方法1：使用腾讯云控制台上传（推荐）**
1. 腾讯云控制台 → 文件管理
2. 上传 `huanboworld.tar.gz` 到 `/root/`
3. 在终端执行：
   ```bash
   cd /root
   tar -xzf huanboworld.tar.gz
   mv HuanboWorld /www/huanboworld
   cd /www/huanboworld
   ```

**方法2：使用SCP上传**
```bash
# 在本地电脑执行
scp huanboworld.tar.gz root@服务器IP:/root/
```

### 第六步：配置环境变量（3分钟）

```bash
# 在服务器上执行，创建环境配置
cd /www/huanboworld
cat > .env << 'EOF'
NODE_ENV=production
PORT=3000

# QQ邮箱配置（推荐）
SMTP_HOST=smtp.qq.com
SMTP_PORT=587
SMTP_USER=你的QQ号@qq.com
SMTP_PASS=你的QQ邮箱授权码

COMPANY_EMAIL=info@huanboworld.com
ADMIN_TOKEN=secure-token-$(date +%s)
EOF
```

### 第七步：启动网站（5分钟）

```bash
# 安装依赖
npm install

# 启动网站
pm2 start server.js --name "huanboworld"

# 设置开机自启
pm2 startup
pm2 save

# 配置Nginx反向代理
cat > /etc/nginx/sites-available/default << 'EOF'
server {
    listen 80;
    server_name _;
    
    location / {
        proxy_pass http://localhost:3000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_cache_bypass $http_upgrade;
    }
}
EOF

# 重启Nginx
systemctl restart nginx

echo "部署完成！访问 http://你的服务器IP 查看网站"
```

### 第八步：配置防火墙（2分钟）

1. **腾讯云控制台配置**
   - 轻量应用服务器 → 防火墙
   - 添加规则：
     ```
     协议：TCP
     端口：80
     来源：0.0.0.0/0
     ```

2. **测试访问**
   - 浏览器访问：`http://你的服务器IP`
   - 应该能看到网站首页

---

## 📧 邮箱配置详细说明

### QQ邮箱配置（推荐）

1. **开启SMTP服务**
   - 登录QQ邮箱：https://mail.qq.com
   - 设置 → 账户
   - 找到"POP3/SMTP服务"
   - 点击"开启"

2. **获取授权码**
   - 系统会要求验证手机
   - 完成验证后获得16位授权码
   - 这个授权码就是SMTP_PASS的值

3. **配置示例**
   ```env
   SMTP_HOST=smtp.qq.com
   SMTP_PORT=587
   SMTP_USER=123456789@qq.com
   SMTP_PASS=abcdefghijklmnop  # 16位授权码
   ```

### 163邮箱配置（备选）

1. **开启SMTP服务**
   - 登录163邮箱：https://mail.163.com
   - 设置 → POP3/SMTP/IMAP
   - 开启"SMTP服务"

2. **设置授权密码**
   - 设置一个客户端授权密码
   - 这个密码用于SMTP_PASS

---

## 🔧 常见问题快速解决

### 问题1：npm install 失败
```bash
# 解决方案：使用国内镜像
npm config set registry https://registry.npmmirror.com
npm install
```

### 问题2：网站打不开
```bash
# 检查应用状态
pm2 status

# 查看日志
pm2 logs huanboworld

# 重启应用
pm2 restart huanboworld
```

### 问题3：邮件发不出去
```bash
# 检查环境变量
cat .env

# 测试邮件配置
node -e "
const nodemailer = require('nodemailer');
const transporter = nodemailer.createTransporter({
  host: 'smtp.qq.com',
  port: 587,
  secure: false,
  auth: {
    user: '你的QQ号@qq.com',
    pass: '你的授权码'
  }
});
transporter.verify((error, success) => {
  if (error) console.log('邮件配置错误:', error);
  else console.log('邮件配置正确');
});
"
```

---

## 🌐 可选：绑定域名

### 如果你有域名

1. **DNS设置**
   ```
   记录类型：A
   主机记录：@
   记录值：你的服务器IP
   TTL：600
   ```

2. **Nginx配置更新**
   ```bash
   # 修改Nginx配置
   nano /etc/nginx/sites-available/default
   
   # 将 server_name _; 改为：
   server_name 你的域名.com www.你的域名.com;
   
   # 重启Nginx
   systemctl restart nginx
   ```

3. **SSL证书（免费）**
   ```bash
   # 安装certbot
   apt install certbot python3-certbot-nginx -y
   
   # 获取SSL证书
   certbot --nginx -d 你的域名.com -d www.你的域名.com
   ```

---

## 📊 成本预算

### 月费用明细
```
腾讯云轻量服务器：¥24/月
域名（可选）：¥4.5/月（¥55/年）
SSL证书：免费

总计：¥24-29/月
```

### 新用户优惠
- 腾讯云新用户通常有代金券
- 首次购买可能有6-8折优惠
- 建议先购买1个月测试

---

## 🎯 部署成功检查清单

### 功能测试
- [ ] 网站首页能正常打开
- [ ] 导航菜单工作正常
- [ ] 联系表单能提交
- [ ] 邮件能正常发送和接收
- [ ] 手机端显示正常
- [ ] 微信内能正常打开

### 性能测试
- [ ] 页面加载速度合理（3秒内）
- [ ] 图片能正常显示
- [ ] 没有明显的错误信息

---

## 📞 需要帮助？

如果在部署过程中遇到问题：

1. **检查步骤**：确认每一步都按说明执行
2. **查看日志**：`pm2 logs huanboworld`
3. **重启服务**：`pm2 restart huanboworld`
4. **防火墙检查**：确保端口80已开放

## 🎉 恭喜！

按照以上步骤，您的环舶物流网站应该已经成功部署并可以被中国大陆用户正常访问了！

### 下一步建议
1. 测试所有功能是否正常
2. 考虑购买域名提升专业度
3. 定期备份网站数据
4. 关注服务器安全更新
